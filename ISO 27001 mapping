What this is:  

This is a compliance mapping for my Microsoft Sentinel project that detects brute-force login attacks and automatically shuts down the targeted VM to stop the attacker.  

I’ve mapped the project to ISO/IEC 27001:2022 — the latest version of the global information security standard. This shows exactly which security controls the project helps to meet.  

Scope  
Watches Windows security logs for repeated failed logins (Event ID 4625 bursts).  

Creates an incident in Sentinel.  

Triggers a Logic App (via Managed Identity) to power off only VMs with a safety tag (AutoShutdown=true).  

Sends a notification to the SOC team.  


Main ISO 27001:2022 Controls Covered  

A.8.15 — Logging  

Goal: Make sure security-relevant events are recorded and can be used for investigation.  

How this project meets it:  

Collects SecurityEvent logs into Log Analytics → Sentinel.  

Uses a KQL rule to detect high-rate login failures.  

Keeps logs based on retention policy and controls who can access them.  

  
A.8.16 — Monitoring Activities 
  
Goal: Keep watch for suspicious activity so you can respond fast.  

How this project meets it:  

Analytic rule runs every 5 minutes.  

Automation Rule fires the Logic App for high-confidence detections.  

Optional workbook shows incidents over time and response metrics.  
  

A.5.15 — Access Control
Goal: Make sure only authorised access is allowed — and cut it off when risk is detected.  

How this project meets it:  

Shuts down only tagged VMs to avoid affecting production accidentally.  

Uses least-privilege permissions for the Logic App Managed Identity.  

Excludes break-glass accounts and known safe sources.  
  
  
How it Runs  

Sentinel detects brute-force pattern.  

Creates incident (<5 min).  

Automation Rule triggers Logic App (<60 sec).  

VM powers off if it matches safety tag.  

SOC team gets notified, and a ticket is raised.
